#!/bin/bash

# Log start time
echo "[$(date)] Starting token update..." >> /app/logs/cron.log

# Run the Node.js script
node /app/update_tokens.js 2>&1 | while read line; do
  echo "[$(date)] $line" >> /app/logs/cron.log
done

# Check if the script was successful
if [ ${PIPESTATUS[0]} -eq 0 ]; then
  echo "[$(date)] Token update completed successfully" >> /app/logs/cron.log
else
  echo "[$(date)] Token update failed" >> /app/logs/cron.log
fi
